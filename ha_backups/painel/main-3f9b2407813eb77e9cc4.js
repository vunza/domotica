/*! For license information please see main-3f9b2407813eb77e9cc4.js.LICENSE.txt */
(()=>{"use strict";var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.nome,i=void 0===n?"[Nome do Dispositivo]":n,o=t.historico,r=void 0===o?"00:00:00, 00/00/0000":o,a=t.tipo,c=void 0===a?"lampada":a,u=t.status,s=void 0===u?"online":u,l=document.getElementById("card_wrapper");if(!document.getElementById(e)){var v,d='\n        <div id="'.concat(e,'" class="card" data-status="').concat(s,'" data-type="').concat(c,'">\n            <div class="srvr_indicator ').concat("online"!==s?"offline":"",'"></div>\n            \n            <div class="card-content">\n                <div class="div_img ').concat(c,'-icon" id="').concat(e,'" onclick="on_click_btn(this.id);">\n                    ').concat((v=c,{hub_zb:'<svg class="svg-icon hub-icon" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="2"></circle><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"></path></svg>',lampada:'<svg class="svg-icon lamp-icon" viewBox="-80 0 512 512" fill="currentColor"><path d="M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"/></svg>',bomba:'<svg class="svg-icon pump-icon" viewBox="0 0 1024 1024" fill="currentColor"><path d="M544.7 703.8v-320c-35.3 0-64 26-64 58.2v203.7c0 32.1 28.6 58.1 64 58.1zM576.7 383.8h288v44.5h-288zM576.7 556.3h288v64h-288zM576.7 460.3h288v64h-288zM960.7 645.6V442c0-32.1-28.7-58.2-64-58.2v320c35.4 0 64-26 64-58.2zM640.7 351.8h160c17.7 0 32-14.3 32-32v-64h-224v64c0 17.7 14.3 32 32 32zM288.7 223.8h64v-64h-64v-64h-64v64h-64v64h64z"/><path d="M832.7 799.8v-64h32v-83.5h-288v83.5h32v64h-320v-160h64v-64h32v32h64v-128h-64v32h-32v-64h-64v-128h64v-64h-192v64h64v128h-32v192h32v96h-128c-35.3 0-64 28.7-64 64v128h960.1v-128H832.7z m-64 0h-96v-64h96v64z"/><path d="M160.7 639.8v-192c-35.3 0-64 28.7-64 64h-64v64h64c0 35.4 28.6 64 64 64z"/></svg>'}[v]||'<svg width="28" height="28" fill="currentColor" viewBox="0 0 24 24" transform="" id="injected-svg"><path d="M21 14V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h9v-2H5v-1.59l3-3 1.29 1.29c.39.39 1.02.39 1.41 0l5.29-5.29 3 3V14h2Zm-4.29-5.71a.996.996 0 0 0-1.41 0l-5.29 5.29-1.29-1.29a.996.996 0 0 0-1.41 0l-2.29 2.29V5h14v5.59L16.73 8.3Z"/><path d="M8.5 7a1.5 1.5 0 1 0 0 3 1.5 1.5 0 1 0 0-3M21 16h-2v3h-3v2h3v3h2v-3h3v-2h-3z"/></svg>'),'\n                </div>\n                \n                <div class="card-info">\n                    <div class="card-header">\n                        <div class="div_nome">').concat(i,'</div>\n                        <div style="display:none" class="config-button" id="').concat(e,'" oncontextmenu="on_click_cfg(this.id);">\n                            ').concat('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>','\n                        </div>\n                    </div>\n                    \n                    <div class="history-section">\n                        <div class="div_img_clk">\n                            ').concat('<svg class="svg-clk" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>','\n                        </div>\n                        <div class="div_historico">').concat(r,"</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ");l.innerHTML+=d}};function t(){var e,i,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(t,o,r,a){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return n(l,"_invoke",function(t,n,o){var r,a,c,s=0,l=o||[],v=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return r=t,a=0,c=e,d.n=n,u}};function f(t,n){for(a=t,c=n,i=0;!v&&s&&!o&&i<l.length;i++){var o,r=l[i],f=d.p,h=r[2];t>3?(o=h===n)&&(c=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=e):r[0]<=f&&((o=t<2&&f<r[1])?(a=0,d.v=n,d.n=r[1]):f<h&&(o=t<3||r[0]>n||n>h)&&(r[4]=t,r[5]=n,d.n=h,a=0))}if(o||t>1)return u;throw v=!0,n}return function(o,l,h){if(s>1)throw TypeError("Generator is already running");for(v&&1===l&&f(l,h),a=l,c=h;(i=a<2?e:c)||!v;){r||(a?a<3?(a>1&&(d.n=-1),f(a,c)):d.n=c:d.v=c);try{if(s=2,r){if(a||(o="next"),i=r[o]){if(!(i=i.call(r,c)))throw TypeError("iterator result is not an object");if(!i.done)return i;c=i.value,a<2&&(a=0)}else 1===a&&(i=r.return)&&i.call(r),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);r=e}else if((i=(v=d.n<0)?c:t.call(n,d))!==u)break}catch(t){r=e,a=1,c=t}finally{s=1}}return{value:i,done:v}}}(t,r,a),!0),l}var u={};function s(){}function l(){}function v(){}i=Object.getPrototypeOf;var d=[][r]?i(i([][r]())):(n(i={},r,function(){return this}),i),f=v.prototype=s.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,n(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=v,n(f,"constructor",v),n(v,"constructor",l),l.displayName="GeneratorFunction",n(v,a,"GeneratorFunction"),n(f),n(f,a,"Generator"),n(f,r,function(){return this}),n(f,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:h}})()}function n(e,t,i,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}n=function(e,t,i,o){function a(t,i){n(e,t,function(e){return this._invoke(t,i,e)})}t?r?r(e,t,{value:i,enumerable:!o,configurable:!o,writable:!o}):e[t]=i:(a("next",0),a("throw",1),a("return",2))},n(e,t,i,o)}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t,n,i,o,r,a){try{var c=e[r](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(i,o)}function r(e){return a.apply(this,arguments)}function a(){return(e=t().m(function e(n){var o,r,a,s;return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch("/api/states",{headers:{Authorization:"Bearer "+n}});case 1:if((o=e.v).ok){e.n=2;break}throw new Error("Falha ao obter entidades");case 2:return e.n=3,o.json();case 3:return r=e.v,a=r.filter(function(e){return e.entity_id}),s=new Map,a.forEach(function(e){var t,n,o=(t=e.entity_id.split("."),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r,a,c=[],u=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=r.call(n)).done)&&(c.push(i.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],a=o[1];s.has(a)||s.set(a,{device_id:a,entities:[],friendly_name:e.attributes.friendly_name||a.replace(/_/g," ").replace(/\b\w/g,function(e){return e.toUpperCase()})}),s.get(a).entities.push({entity_id:e.entity_id,domain:r,state:e.state,attributes:e.attributes})}),e.a(2,Array.from(s.values()).map(function(e){var t=e.entities.find(function(e){return"switch"===e.domain||"light"===e.domain})||e.entities[0];return{id:e.device_id,nome:e.friendly_name,tipo:c(e),status:u(e.entities),historico:(new Date).toLocaleString("pt-PT"),entities:e.entities,main_entity:t}}))}},e)}),a=function(){var t=this,n=arguments;return new Promise(function(i,r){var a=e.apply(t,n);function c(e){o(a,i,r,c,u,"next",e)}function u(e){o(a,i,r,c,u,"throw",e)}c(void 0)})}).apply(this,arguments);var e}function c(e){var t=e.entities.map(function(e){return e.domain});return t.includes("light")?"lampada":t.includes("switch")?"switch":t.includes("sensor")?"sensor":"dispositivo"}function u(e){return e.filter(function(e){return"unavailable"!==e.state&&"unknown"!==e.state}).length>0?"online":"offline"}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,v(i.key),i)}}function v(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var d=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.navItems=document.querySelectorAll(".nav-item"),this.pages=document.querySelectorAll(".page"),this.currentPage="home-page",this.init()},t=[{key:"init",value:function(){var e=this;this.navItems.forEach(function(t){t.addEventListener("click",function(n){n.preventDefault();var i=t.getAttribute("data-page");e.navigateTo(i)}),t.addEventListener("keydown",function(n){if("Enter"===n.key||" "===n.key){n.preventDefault();var i=t.getAttribute("data-page");e.navigateTo(i)}})}),this.navigateTo("home-page")}},{key:"navigateTo",value:function(e){if(this.currentPage!==e){this.currentPage=e,this.pages.forEach(function(e){e.style.display="none"});var t=document.getElementById(e);t&&(t.style.display="block"),this.updateActiveState(e),history.pushState({page:e},"","#".concat(e)),this.dispatchNavigationEvent(e)}}},{key:"updateActiveState",value:function(e){this.navItems.forEach(function(t){t.getAttribute("data-page")===e?(t.classList.add("active"),t.setAttribute("aria-current","page")):(t.classList.remove("active"),t.removeAttribute("aria-current"))})}},{key:"dispatchNavigationEvent",value:function(e){var t=new CustomEvent("pageChanged",{detail:{pageId:e,pageTitle:this.getPageTitle(e)}});document.dispatchEvent(t)}},{key:"getPageTitle",value:function(e){return{"home-page":"PÃ¡gina Inicial","search-page":"Pesquisa","favorites-page":"Favoritos","profile-page":"Perfil","menu-page":"Menu"}[e]||"PÃ¡gina"}}],t&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),f=document.querySelector(".navbar_inicial");document.querySelector(".bottom-nav"),window.addEventListener("contextmenu",function(e){e.preventDefault()},!1),f.addEventListener("contextmenu",function(e){e.preventDefault(),document.getElementById("more-menu").click()});var h="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJjMDUwYTVkNTMzZDU0ZjBmODJlY2NjZmQyZDgwZDRlYyIsImlhdCI6MTczNjcxNzU1NSwiZXhwIjoyMDUyMDc3NTU1fQ.oLIiyFN8c4lPCAgIPL_sFEWI12P3IcsLsid4KL8A2D0",p=window.location.protocol;function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,w(i.key),i)}}function b(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}"".concat(p,"//").concat(location.host);var k=function(){return b(function e(){y(this,e),this.submenuOverlay=document.getElementById("submenuOverlay"),this.moreMenuButton=document.getElementById("more-menu"),this.closeButton=document.getElementById("closeSubmenu"),this.submenuItems=document.querySelectorAll(".submenu-item"),this.init()},[{key:"init",value:function(){var e=this;this.moreMenuButton.addEventListener("click",function(t){t.preventDefault(),e.openSubmenu()}),this.closeButton.addEventListener("click",function(){e.closeSubmenu()}),this.submenuOverlay.addEventListener("click",function(t){t.target===e.submenuOverlay&&e.closeSubmenu()}),document.addEventListener("keydown",function(t){"Escape"===t.key&&"none"!==e.submenuOverlay.style.display&&e.closeSubmenu()}),this.submenuItems.forEach(function(t){t.addEventListener("click",function(){var n=t.getAttribute("data-action");e.handleSubmenuAction(n)})})}},{key:"openSubmenu",value:function(){var e=this;this.submenuOverlay.style.display="flex",document.body.style.overflow="hidden",setTimeout(function(){e.closeButton.focus()},100)}},{key:"closeSubmenu",value:function(){this.submenuOverlay.style.display="none",document.body.style.overflow=""}},{key:"handleSubmenuAction",value:function(e){switch(console.log("AÃ§Ã£o do submenu:",e),this.closeSubmenu(),e){case"config-devices":this.configureDevices();break;case"add-device":this.addDevice();break;case"remove-device":this.removeDevice();break;case"settings":this.openSettings();break;case"backup":this.createBackup();break;case"about":this.showAbout();break;default:console.warn("AÃ§Ã£o nÃ£o reconhecida:",e)}}},{key:"configureDevices",value:function(){document.getElementById("card_wrapper").innerHTML="",r(h).then(function(t){t.forEach(function(t){e(t.id,{nome:t.nome,historico:t.historico,tipo:t.tipo,status:t.status})})}).catch(function(e){return console.error("Erro ao obter a lista de dispositivos:",e),[]})}},{key:"addDevice",value:function(){console.log("ðŸ”„ Abrindo modal para adicionar dispositivo..."),alert("Adicionar Dispositivo - Implemente esta funcionalidade")}},{key:"removeDevice",value:function(){console.log("ðŸ—‘ï¸ Abrindo modal para remover dispositivo..."),alert("Remover Dispositivo - Implemente esta funcionalidade")}},{key:"openSettings",value:function(){console.log("âš™ï¸ Abrindo configuraÃ§Ãµes..."),alert("ConfiguraÃ§Ãµes - Implemente esta funcionalidade")}},{key:"createBackup",value:function(){console.log("ðŸ’¾ Criando backup..."),alert("Fazer Backup - Implemente esta funcionalidade")}},{key:"showAbout",value:function(){console.log("â„¹ï¸ Mostrando informaÃ§Ãµes..."),alert("Sobre - Implemente esta funcionalidade")}}])}(),S=function(){return b(function e(){y(this,e),this.navItems=document.querySelectorAll(".nav-item"),this.pages=document.querySelectorAll(".page"),this.currentPage="home-page",this.submenuManager=new k,this.init()},[{key:"init",value:function(){var e=this;this.navItems.forEach(function(t){t.addEventListener("click",function(n){n.preventDefault();var i=t.getAttribute("data-page");"menu-page"!==i&&("refresh-page"===i?e.handleRefresh():e.navigateTo(i))})}),this.navigateTo("home-page")}},{key:"navigateTo",value:function(e){if(this.currentPage!==e){this.currentPage=e,this.pages.forEach(function(e){e.style.display="none"});var t=document.getElementById(e);t&&(t.style.display="block"),this.updateActiveState(e),history.pushState({page:e},"","#".concat(e)),this.dispatchNavigationEvent(e)}}}])}();document.addEventListener("DOMContentLoaded",function(){r(h).then(function(t){t.forEach(function(t){e(t.id,{nome:t.nome,historico:t.historico,tipo:t.tipo,status:t.status})})}).catch(function(e){return console.error("Erro ao obter dados dos dispositivos:",e),[]});var t=new d,n=(new S,window.location.hash.substring(1));n&&document.getElementById(n)&&t.navigateTo(n)}),document.addEventListener("touchstart",function(){},{passive:!0})})();